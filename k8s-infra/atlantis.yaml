version: 3
projects:
  - name: k8s-infra
    dir: . # Корневая директория проекта
    workspace: default
    autoplan:
      enabled: true
      when_modified: ["*.tf", "../modules/**/*.tf", "*.tfvars", ".terraform.lock.hcl"]
    workflow: terraform
workflows:
  terraform:
    plan:
      steps:
        - init
        - plan
    apply:
      steps:
        - apply
